{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/satoshishimamurasecond/Desktop/SatoshiShimamura/60_Udemy/2020_ShopAppUsingReactNativeAndFirebase/src/Section06/src/screens/CreateReviewScreen.tsx\";\n\nimport React, { useContext, useLayoutEffect, useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport View from \"react-native-web/dist/exports/View\";\nimport firebase from \"firebase\";\nimport { addReview } from \"../lib/firebase\";\nimport { pickImage } from \"../lib/image-picker\";\nimport { UserContext } from \"../contexts/userContexts\";\nimport { IconButton } from \"../components/IconButton\";\nimport { TextArea } from \"../components/TextArea\";\nimport { StarInput } from \"../components/StarInput\";\nimport { Button } from \"../components/Button\";\nexport var CreateReviewScreen = function CreateReviewScreen(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n  var shop = route.params.shop;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      text = _useState2[0],\n      setText = _useState2[1];\n\n  var _useState3 = useState(3),\n      _useState4 = _slicedToArray(_useState3, 2),\n      score = _useState4[0],\n      setScore = _useState4[1];\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.user;\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      imageUri = _useState6[0],\n      setImageUri = _useState6[1];\n\n  useLayoutEffect(function () {\n    navigation.setOptions({\n      title: shop.name,\n      headerLeft: function headerLeft() {\n        return React.createElement(IconButton, {\n          onPress: function onPress() {\n            return navigation.goBack();\n          },\n          name: \"x\",\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 37,\n            columnNumber: 9\n          }\n        });\n      }\n    });\n  }, [navigation, shop]);\n\n  var onSubmit = function onSubmit() {\n    var review;\n    return _regeneratorRuntime.async(function onSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            review = {\n              user: {\n                name: user.name,\n                id: user.id\n              },\n              shop: {\n                name: shop.name,\n                id: shop.id\n              },\n              text: text,\n              score: score,\n              updatedAt: firebase.firestore.Timestamp.now(),\n              createdAt: firebase.firestore.Timestamp.now()\n            };\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(addReview(shop.id, review));\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var onPickImage = function onPickImage() {\n    var uri;\n    return _regeneratorRuntime.async(function onPickImage$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(pickImage());\n\n          case 2:\n            uri = _context2.sent;\n            setImageUri(uri);\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(SafeAreaView, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 5\n    }\n  }, React.createElement(StarInput, {\n    score: score,\n    onChangeScore: function onChangeScore(value) {\n      return setScore(value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }), React.createElement(TextArea, {\n    value: text,\n    onChangeText: function onChangeText(value) {\n      return setText(value);\n    },\n    label: \"\\u30EC\\u30D3\\u30E5\\u30FC\",\n    placeholder: \"\\u30EC\\u30D3\\u30E5\\u30FC\\u3092\\u66F8\\u3044\\u3066\\u304F\\u3060\\u3055\\u3044\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }, React.createElement(IconButton, {\n    name: \"camera\",\n    onPress: onPickImage,\n    color: \"#ccc\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 10\n    }\n  }), !!imageUri && React.createElement(Image, {\n    source: {\n      uri: imageUri\n    },\n    style: styles.image,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 25\n    }\n  })), React.createElement(Button, {\n    text: \"\\u30EC\\u30D3\\u30E5\\u30FC\\u3092\\u6295\\u7A3F\\u3059\\u308B\",\n    onPress: onSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }\n  }));\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#fff\"\n  },\n  photoCOntainer: {\n    margin: 8\n  },\n  image: {\n    width: 100,\n    height: 100,\n    margin: 8\n  }\n});","map":{"version":3,"sources":["/Users/satoshishimamurasecond/Desktop/SatoshiShimamura/60_Udemy/2020_ShopAppUsingReactNativeAndFirebase/src/Section06/src/screens/CreateReviewScreen.tsx"],"names":["React","useContext","useLayoutEffect","useState","firebase","addReview","pickImage","UserContext","IconButton","TextArea","StarInput","Button","CreateReviewScreen","navigation","route","shop","params","text","setText","score","setScore","user","imageUri","setImageUri","setOptions","title","name","headerLeft","goBack","onSubmit","review","id","updatedAt","firestore","Timestamp","now","createdAt","onPickImage","uri","styles","container","value","image","StyleSheet","create","flex","backgroundColor","photoCOntainer","margin","width","height"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,UAAhB,EAA4BC,eAA5B,EAA6CC,QAA7C,QAA6D,OAA7D;;;;AAEA,OAAOC,QAAP,MAAqB,UAArB;AACA,SAAQC,SAAR;AACA,SAASC,SAAT;AACA,SAAQC,WAAR;AAEA,SAASC,UAAT;AACA,SAASC,QAAT;AACA,SAASC,SAAT;AACA,SAASC,MAAT;AAYA,OAAO,IAAMC,kBAAmC,GAAG,SAAtCA,kBAAsC,OAGtC;AAAA,MAFXC,UAEW,QAFXA,UAEW;AAAA,MADXC,KACW,QADXA,KACW;AAAA,MACHC,IADG,GACMD,KAAK,CAACE,MADZ,CACHD,IADG;;AAAA,kBAEaZ,QAAQ,CAAS,EAAT,CAFrB;AAAA;AAAA,MAEJc,IAFI;AAAA,MAEEC,OAFF;;AAAA,mBAGef,QAAQ,CAAS,CAAT,CAHvB;AAAA;AAAA,MAGJgB,KAHI;AAAA,MAGGC,QAHH;;AAAA,oBAIInB,UAAU,CAACM,WAAD,CAJd;AAAA,MAIJc,IAJI,eAIJA,IAJI;;AAAA,mBAKqBlB,QAAQ,CAAS,EAAT,CAL7B;AAAA;AAAA,MAKJmB,QALI;AAAA,MAKMC,WALN;;AAOXrB,EAAAA,eAAe,CAAC,YAAM;AACpBW,IAAAA,UAAU,CAACW,UAAX,CAAsB;AACpBC,MAAAA,KAAK,EAAEV,IAAI,CAACW,IADQ;AAEpBC,MAAAA,UAAU,EAAE;AAAA,eACV,oBAAC,UAAD;AAAY,UAAA,OAAO,EAAE;AAAA,mBAAMd,UAAU,CAACe,MAAX,EAAN;AAAA,WAArB;AAAgD,UAAA,IAAI,EAAC,GAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADU;AAAA;AAFQ,KAAtB;AAMD,GAPc,EAOZ,CAACf,UAAD,EAAaE,IAAb,CAPY,CAAf;;AASA,MAAMc,QAAQ,GAAG,SAAXA,QAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AACTC,YAAAA,MADS,GACA;AACbT,cAAAA,IAAI,EAAE;AACJK,gBAAAA,IAAI,EAAEL,IAAI,CAACK,IADP;AAEJK,gBAAAA,EAAE,EAAEV,IAAI,CAACU;AAFL,eADO;AAKbhB,cAAAA,IAAI,EAAE;AACJW,gBAAAA,IAAI,EAAEX,IAAI,CAACW,IADP;AAEJK,gBAAAA,EAAE,EAAEhB,IAAI,CAACgB;AAFL,eALO;AASbd,cAAAA,IAAI,EAAJA,IATa;AAUbE,cAAAA,KAAK,EAALA,KAVa;AAWba,cAAAA,SAAS,EAAE5B,QAAQ,CAAC6B,SAAT,CAAmBC,SAAnB,CAA6BC,GAA7B,EAXE;AAYbC,cAAAA,SAAS,EAAEhC,QAAQ,CAAC6B,SAAT,CAAmBC,SAAnB,CAA6BC,GAA7B;AAZE,aADA;AAAA;AAAA,6CAeT9B,SAAS,CAACU,IAAI,CAACgB,EAAN,EAAUD,MAAV,CAfA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAkBA,MAAMO,WAAW,GAAG,SAAdA,WAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CACA/B,SAAS,EADT;;AAAA;AACZgC,YAAAA,GADY;AAElBf,YAAAA,WAAW,CAACe,GAAD,CAAX;;AAFkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAApB;;AAKA,SACE,oBAAC,YAAD;AAAc,IAAA,KAAK,EAAEC,MAAM,CAACC,SAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAErB,KAAlB;AAAyB,IAAA,aAAa,EAAE,uBAACsB,KAAD;AAAA,aAAWrB,QAAQ,CAACqB,KAAD,CAAnB;AAAA,KAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,oBAAC,QAAD;AACC,IAAA,KAAK,EAAExB,IADR;AAEC,IAAA,YAAY,EAAE,sBAACwB,KAAD;AAAA,aAAWvB,OAAO,CAACuB,KAAD,CAAlB;AAAA,KAFf;AAGC,IAAA,KAAK,EAAC,0BAHP;AAIC,IAAA,WAAW,EAAC,0EAJb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,EAQE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEF,MAAM,CAACC,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,oBAAC,UAAD;AAAY,IAAA,IAAI,EAAC,QAAjB;AAA0B,IAAA,OAAO,EAAEH,WAAnC;AAAgD,IAAA,KAAK,EAAC,MAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADH,EAEI,CAAC,CAACf,QAAF,IAAc,oBAAC,KAAD;AAAO,IAAA,MAAM,EAAE;AAACgB,MAAAA,GAAG,EAAEhB;AAAN,KAAf;AAAgC,IAAA,KAAK,EAAEiB,MAAM,CAACG,KAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFlB,CARF,EAYE,oBAAC,MAAD;AAAQ,IAAA,IAAI,EAAC,wDAAb;AAAyB,IAAA,OAAO,EAAEb,QAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAZF,CADF;AAgBD,CA1DM;AA4DP,IAAMU,MAAM,GAAGI,UAAU,CAACC,MAAX,CAAkB;AAC/BJ,EAAAA,SAAS,EAAE;AACTK,IAAAA,IAAI,EAAE,CADG;AAETC,IAAAA,eAAe,EAAE;AAFR,GADoB;AAK/BC,EAAAA,cAAc,EAAE;AACdC,IAAAA,MAAM,EAAE;AADM,GALe;AAQ/BN,EAAAA,KAAK,EAAE;AACLO,IAAAA,KAAK,EAAE,GADF;AAELC,IAAAA,MAAM,EAAE,GAFH;AAGLF,IAAAA,MAAM,EAAE;AAHH;AARwB,CAAlB,CAAf","sourcesContent":["import React, { useContext, useLayoutEffect, useState } from \"react\";\nimport { StyleSheet, SafeAreaView, Text, View } from \"react-native\";\nimport firebase from \"firebase\";\nimport {addReview} from \"../lib/firebase\";\nimport { pickImage } from \"../lib/image-picker\";\nimport {UserContext} from \"../contexts/userContexts\";\n/* components */\nimport { IconButton } from \"../components/IconButton\";\nimport { TextArea } from \"../components/TextArea\";\nimport { StarInput } from \"../components/StarInput\";\nimport { Button } from \"../components/Button\";\n/* types */\nimport { StackNavigationProp } from \"@react-navigation/stack\";\nimport { RootStackParamList } from \"../types/navigation\";\nimport { RouteProp } from \"@react-navigation/native\";\nimport { Review } from \"../types/review\";\n\ntype Props = {\n  navigation: StackNavigationProp<RootStackParamList, \"CreateReview\">;\n  route: RouteProp<RootStackParamList, \"CreateReview\">;\n};\n\nexport const CreateReviewScreen: React.FC<Props> = ({\n  navigation,\n  route,\n}: Props) => {\n  const { shop } = route.params;\n  const [text, setText] = useState<string>(\"\");\n  const [score, setScore] = useState<number>(3);\n  const {user} = useContext(UserContext);\n  const [imageUri, setImageUri] = useState<string>(\"\");\n\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      title: shop.name,\n      headerLeft: () => (\n        <IconButton onPress={() => navigation.goBack()} name=\"x\" />\n      ),\n    });\n  }, [navigation, shop]);\n\n  const onSubmit = async () => {\n    const review = {\n      user: {\n        name: user.name,\n        id: user.id,\n      },\n      shop: {\n        name: shop.name,\n        id: shop.id,\n      },\n      text,\n      score,\n      updatedAt: firebase.firestore.Timestamp.now(),\n      createdAt: firebase.firestore.Timestamp.now(),\n    } as Review;\n    await addReview(shop.id, review)\n  };\n\n  const onPickImage = async () =>{\n    const uri = await pickImage();\n    setImageUri(uri);\n  };\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <StarInput score={score} onChangeScore={(value) => setScore(value)} />\n      <TextArea \n      　value={text} \n      　onChangeText={(value) => setText(value)} \n      　label=\"レビュー\"\n      　placeholder=\"レビューを書いてください\"\n      />\n      <View style={styles.container}>\n         <IconButton name=\"camera\" onPress={onPickImage} color=\"#ccc\" />\n         {!!imageUri && <Image source={{uri: imageUri}} style={styles.image} />}\n      </View>\n      <Button text=\"レビューを投稿する\" onPress={onSubmit} />\n    </SafeAreaView>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n  },\n  photoCOntainer: {\n    margin: 8,\n  },\n  image: {\n    width: 100,\n    height: 100,\n    margin: 8,\n  },\n});"]},"metadata":{},"sourceType":"module"}